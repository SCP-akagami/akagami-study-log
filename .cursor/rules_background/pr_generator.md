# PR Generator ルール背景説明

このファイルは [pr_generator.mdc](mdc:.cursor/rules/pr_generator.mdc) の背景情報を提供します。

## [1. 現在作業中のブランチを確認し、そのブランチでPRを作成する認識でよいかユーザーに確認する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
Pull Requestは通常、特定のfeatureブランチからmainブランチへのマージを目的として作成されます。
しかし、開発者が意図していないブランチでPRを作成してしまう可能性があります。

### 策定理由
- 誤ったブランチでのPR作成を防ぐため
- 開発者の意図を明確にするため
- 作業の整合性を保つため

### 実例
```
現在のブランチ: feature-user-authentication
PRを作成しようとしています。このブランチでPRを作成してよろしいですか？
```

## [2. 関連するIssueがある場合、そのIssue内容をマークダウン形式でユーザーに提供してもらうよう要求し、提供された内容を分析してPRの背景と目的を把握する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
PRの多くは特定のIssueを解決するために作成されます。
ローカル環境からリモートのIssueに直接アクセスできないため、ユーザーにマークダウン形式で Issue内容を提供してもらい、それを分析してPRの文脈、目的、期待される成果を正確に理解する必要があります。

### 策定理由
- ローカル環境の制約への対応
- PRの背景と目的の早期理解
- Issue内容に基づく適切なPR分類
- レビューポイントの事前特定
- Issue-PR間の一貫性確保

### 実例
```
ユーザーに要求：「関連するIssueがある場合、その内容をマークダウン形式で提供してください」
提供された内容：
# Issue #123: ログイン画面のレスポンス改善
## 概要
ログイン画面の応答速度が遅く、ユーザビリティに影響している
## 期待される結果
- 応答速度の50%改善
- クエリ最適化の実施

→ パフォーマンス改善が目的であることが判明
→ 【パフォーマンス】タイプのPRとして判定
→ レビューポイント：クエリ最適化、メモリ使用量
```

## [3. gitコマンドを使用して現在のブランチとmainブランチの差分を取得し、関連するコミット情報も収集する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
PR作成時には変更内容の全体像を把握する必要があります。
git diffとgit logの情報はPRの品質を大きく左右します。

### 策定理由
- 変更内容の自動検出によるPR作成の効率化
- コミットメッセージからの文脈理解
- 見落としがちな変更の発見

### 実例
```bash
git diff main...HEAD --name-only
git log main..HEAD --oneline
git diff main...HEAD --stat
```

## [4. git差分とコミット情報、Issue内容を分析して、PRの種類を以下から判定しユーザーに確認する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
PRの種類によって、レビューの観点やテスト方法が異なります。
Issue内容とgit情報を組み合わせることで、より正確な判定が可能になります。

### 策定理由
- Issue内容も考慮した包括的な判定
- レビュアーにとって分かりやすいPRタイトルの生成
- 適切なレビュー観点の提示
- ラベルの自動選択による分類整理

### 実例
- Issue: バグ報告 + git diff: 修正コード → 【バグ修正】
- Issue: 新機能要望 + git diff: 新ファイル追加 → 【新機能】
- Issue: パフォーマンス改善 + git diff: クエリ最適化 → 【パフォーマンス】

## [5. 必要に応じて以下の詳細情報をユーザーから追加収集する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
Issue内容とgitの情報だけでは、開発者の具体的な実装意図や注意点を完全に把握できません。
レビュアーが効率的にレビューするための補足情報が必要です。

### 策定理由
- Issue内容では不足する実装詳細の補完
- レビューポイントの明確化
- テスト状況の把握
- デプロイ時の注意点の共有

### 実例
```
特に注意してレビューしてもらいたい点: 新しいキャッシュ機能の実装ロジック
テスト状況: 単体テスト実施済み、結合テスト要確認
デプロイ時の注意点: DBマイグレーションが必要
```

## [6. 収集した情報（Issue内容、git差分、コミット情報）を元にPR_TEMPLATEの構造に従ってGitHub Pull Request形式のマークダウンを生成する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
一貫したPRフォーマットは、レビューの効率性と品質を向上させます。
Issue内容も含めた包括的な情報でテンプレートを生成することで、より充実したPRが作成できます。

### 策定理由
- PRの品質標準化
- Issue-PR間の一貫性確保
- レビュー効率の向上
- 必要な情報の漏れ防止

### 実例
標準化されたPRには以下が含まれます：
- Issue内容に基づく概要と背景
- git差分から抽出した変更内容
- コミット情報から推測される実装方針

## [7. タイトルは【種類】の形式で始め、Issue内容と変更内容を踏まえて簡潔に表現する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
PRタイトルはGitHubのPR一覧で最初に目に入る情報です。
Issue内容と実際の変更内容の両方を考慮することで、より正確で分かりやすいタイトルが作成できます。

### 策定理由
- Issue内容と実装の整合性確認
- 一目で内容を理解できるタイトル作成
- PR一覧での視認性向上
- レビュー優先度の判断支援

### 実例
```
Issue: 「ユーザー認証の不具合修正」+ 実装: OAuth2ライブラリ更新
→ 【バグ修正】OAuth2認証エラーの修正

Issue: 「検索機能の追加」+ 実装: Elasticsearch統合
→ 【新機能】Elasticsearch を活用した検索機能の追加
```

## [8. 適切なラベルを以下から自動選択し提案する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
GitHubラベルはPRの分類と検索性を向上させます。
変更内容に基づく自動選択により、ラベル付けの一貫性が保たれます。

### 策定理由
- PR分類の自動化
- 検索性の向上
- プロジェクト管理の効率化

### 実例
- 新機能追加 → enhancement
- バグ修正 → bug
- ドキュメント更新 → documentation

## [9. PR生成後、ユーザーの要望に基づいて内容を改善し最終版を提供する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
自動生成されたPRが常に完璧とは限りません。
ユーザーのフィードバックによる改善が品質向上に不可欠です。

### 策定理由
- ユーザー固有の要件への対応
- PR品質の最終確認
- 継続的な改善プロセスの確立

### 実例
```
「テスト状況をもっと詳しく」
「レビューポイントにセキュリティ観点を追加」
「関連Issueの説明を補強」
```

## [10. 各セクションは変更内容、テスト状況、レビューポイントが明確でレビュアーにとって有用な情報を含むよう作成する](mdc:.cursor/rules/pr_generator.mdc)

### 背景
レビュアーの時間は貴重なリソースです。
明確で有用な情報により、効率的なレビューが可能になります。

### 策定理由
- レビューアーの負荷軽減
- レビュー品質の向上
- 開発チーム全体の生産性向上

### 実例
明確な情報とは：
- 具体的な変更ファイルとその理由
- 実施したテストの種類と結果
- 重点的にレビューすべき箇所の特定 